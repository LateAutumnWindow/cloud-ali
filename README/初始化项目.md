# 初始化项目

## 1. GitClone项目

```txt
git clone https://github.com/LateAutumnWindow/cloud-ali.git
```

## 2. 安装Nacos

```txt
1. Docker 安装：
	1.1 DockerHub地址：https://hub.docker.com/r/nacos/nacos-server
		命令：docker pull nacos/nacos-server
	
	1.2	新建挂载文件按和日志文件夹	
		/home/nacos/logs
		/home/nacos/init.d/custom.properties
	
	1.3 增加配置 custom.properties
		请看 2.1 custom.properties 配置
	
	1.4 启动命令：
		docker run  --name nacos-ali -e MODE=standalone -e SPRING_DATASOURCE_PLATFORM=mysql -e MYSQL_MASTER_SERVICE_HOST=127.0.0.1 -e MYSQL_MASTER_SERVICE_USER=root -e MYSQL_MASTER_SERVICE_PASSWORD=123456 -p 8848:8848 --privileged=true --restart=always -e JVM_XMS=256m -e JVM_XMX=256m -v /home/nacos/logs:/home/nacos/logs -v /home/nacos/init.d/custom.properties:/home/nacos/init.d/custom.properties -d nacos/nacos-server

		解析：
		docker run 
			// 容器名
			--name nacos-ali
			
			// 单机模式
			-e MODE=standalone 
			
			// 这里设置的是数据库，nacos 所有的配置都会存到数据库了
			-e SPRING_DATASOURCE_PLATFORM=mysql
            -e MYSQL_MASTER_SERVICE_HOST=127.0.0.1
            -e MYSQL_MASTER_SERVICE_USER=root
            -e MYSQL_MASTER_SERVICE_PASSWORD=123456
            // 端口映射 (linux对外端口:容器内端口)
            -p 8848:8848
        	--privileged=true
			--restart=always
			
			// -e 这两个是设置的内存
			-e JVM_XMS=256m
			-e JVM_XMX=256m
			
			// -v 这两个是挂载的文件夹
			-v /home/nacos/logs:/home/nacos/logs
			-v /home/nacos/init.d/custom.properties:/home/nacos/init.d/custom.properties
			-d nacos/nacos-server
			
	1.5 访问 http://xxx.xxx.xxx.xxx:8848/nacos/
		账号密码：nacos/nacos

```

### 2.1 custom.properties

```prope
server.contextPath=/nacos
server.servlet.contextPath=/nacos
server.port=8848

spring.datasource.platform=mysql

db.num=1
db.url.0=jdbc:mysql://xx.xx.xx.xx:3306/nacos?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true
db.user=数据库的账号											
db.password=数据库的密码


nacos.cmdb.dumpTaskInterval=3600
nacos.cmdb.eventTaskInterval=10
nacos.cmdb.labelTaskInterval=300
nacos.cmdb.loadDataAtStart=false

management.metrics.export.elastic.enabled=false
management.metrics.export.influx.enabled=false


server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%h %l %u %t "%r" %s %b %D %{User-Agent}i


nacos.security.ignore.urls=/,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-fe/public/**,/v1/auth/login,/v1/console/health/**,/v1/cs/**,/v1/ns/**,/v1/cmdb/**,/actuator/**,/v1/console/server/**
nacos.naming.distro.taskDispatchThreadCount=1
nacos.naming.distro.taskDispatchPeriod=200
nacos.naming.distro.batchSyncKeyCount=1000
nacos.naming.distro.initDataRatio=0.9
nacos.naming.distro.syncRetryDelay=5000
nacos.naming.data.warmup=true
nacos.naming.expireInstance=true
```

